"use strict";(self.webpackChunkfestum_evento=self.webpackChunkfestum_evento||[]).push([[25],{1025:(st,v,r)=>{r.r(v),r.d(v,{PromoteModule:()=>ot});var d=r(6895),m=r(5072),t=r(4650),T=r(1236);let y=(()=>{class o{constructor(e){this._router=e}ngOnInit(){localStorage.removeItem("selectAll"),(!localStorage.getItem("nId")||""==localStorage.getItem("nId"))&&this._router.navigate(["/notifications"]),this.items=[{label:"Select User Type",routerLink:"user-type"},{label:"User",routerLink:"users"},{label:"Publish Date & Time",routerLink:"publish-date-and-time"},{label:"Bill Details",routerLink:"bill-details"},{label:"Payment",routerLink:"bill-details"}]}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(m.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-promote"]],decls:11,vars:2,consts:[[1,"wrapper","flex","flex-col","min-h-full"],[1,"space-y-8"],[1,"flex","justify-between","items-center"],[1,"flex","items-center"],["routerLink","..",1,"icon-left_arrow","cursor-pointer","mr-4","text-2xl"],[1,"w-full","overflow-hidden","overflow-x-auto","capitalize"],[3,"model","readonly"],[1,"outletPortal","pt-8","max-h-full","overflow-auto"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t._UZ(4,"i",4),t.TgZ(5,"h2"),t._uU(6,"Promote"),t.qZA()()(),t.TgZ(7,"div",5),t._UZ(8,"p-steps",6),t.qZA()(),t.TgZ(9,"div",7),t._UZ(10,"router-outlet"),t.qZA()()),2&e&&(t.xp6(8),t.Q6J("model",i.items)("readonly",!1))},dependencies:[m.lC,m.rH,T.R],styles:[".ui-steps .ui-steps-item{width:25%}  .ui-steps.steps-custom{margin-bottom:30px}  .ui-steps.steps-custom .ui-steps-item .ui-menuitem-link{padding:0 1em;overflow:visible}  .ui-steps.steps-custom .ui-steps-item .ui-steps-number{background-color:#0081c2;color:#fff;display:inline-block;width:36px;border-radius:50%;margin-top:-14px;margin-bottom:10px}  .ui-steps.steps-custom .ui-steps-item .ui-steps-title{color:#555}  .outletPortal{display:flex;flex-direction:column;min-height:calc(100vh - 288px)}  .innerContent{max-height:calc(100vh - 510px);overflow-y:auto}  app-user-types,   app-users,   app-publish-date-and-time,   app-bill-details{display:flex;flex-direction:column;min-height:calc(100vh - 316px)}"]}),o})();var a=r(4006),h=r(3144),_=r(5922),u=r(2340),C=r(529),f=r(3053);let b=(()=>{class o{constructor(e,i){this.http=e,this._globalFunctions=i}getNotificationById(e){return this.http.post(u.N.appURL+"organizer/notification/getone",{notificationid:e},this._globalFunctions.getAuthorizationHeader())}saveUserType(e){return this.http.post(u.N.appURL+"organizer/notification/selectusertype",e,this._globalFunctions.getAuthorizationHeader())}saveUsers(e){return this.http.post(u.N.appURL+"organizer/notification/selectusers",e,this._globalFunctions.getAuthorizationHeader())}saveSchedule(e){return this.http.post(u.N.appURL+"organizer/notification/setschedule",e,this._globalFunctions.getAuthorizationHeader())}getImportedUsersList(e){return this.http.post(u.N.appURL+"organizer/notification/userlist",e,this._globalFunctions.getAuthorizationHeader())}checkAllUser(e){return this.http.post(u.N.appURL+"organizer/notification/checkalluser",e,this._globalFunctions.getAuthorizationHeader())}checkUser(e){return this.http.post(u.N.appURL+"organizer/notification/checkuser",e,this._globalFunctions.getAuthorizationHeader())}getCouponsList(){return this.http.get(u.N.appURL+"organizer/notificationcoupons/list",this._globalFunctions.getAuthorizationHeader())}getSettings(e=""){return this.http.get(u.N.appURL+"organizer/notification/setting?notificationid="+e,this._globalFunctions.getAuthorizationHeader())}importUsersCSV(e){return this.http.post(u.N.appURL+"organizer/notification/import",e,this._globalFunctions.getFileAuthorizationHeader())}getPromotionPlans(){return this.http.get(u.N.appURL+"organizer/promotionplan/list",this._globalFunctions.getAuthorizationHeader())}processPayment(e={}){return this.http.post(u.N.appURL+"organizer/notification/paynow",e,this._globalFunctions.getAuthorizationHeader())}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(C.eN),t.LFG(f.E))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var x=r(7465);function O(o,s){if(1&o&&(t.TgZ(0,"div",11)(1,"label",12),t._UZ(2,"input",13)(3,"span",14),t.TgZ(4,"div",15),t._UZ(5,"img",16),t.qZA(),t.TgZ(6,"p",17),t._uU(7),t.qZA()()()),2&o){const e=s.$implicit;t.xp6(1),t.Q6J("id",null==e?null:e.value),t.xp6(1),t.Q6J("id",null==e?null:e.value)("value",null==e?null:e.value),t.xp6(3),t.Q6J("src",null==e?null:e.url,t.LSH)("alt",null==e?null:e.type),t.xp6(2),t.Oqu(null==e?null:e.type)}}let A=(()=>{class o{constructor(e,i,n,l,c,p){this._formBuilder=e,this._sNotify=i,this._promoteService=n,this._router=l,this._globalFunctions=c,this._globalService=p,this.constants=h.t,this.notificationObj={},this.isLoading=!1}ngOnInit(){localStorage.removeItem("selectAll"),this.nId=localStorage.getItem("nId"),this.nId&&""!=this.nId?(this._prepareUserTypesForm(),this.notificationObj=this._globalService.promoteNotification$.getValue(),this.notificationObj&&this.notificationObj._id&&""!=this.notificationObj._id?this._prepareUserTypesForm(this.notificationObj):this.getNotificationById()):this._router.navigate(["notifications"])}getNotificationById(){this.isLoading=!0,this._promoteService.getNotificationById(this.nId).subscribe(e=>{e&&e.IsSuccess?(this._globalService.promoteNotification$.next(e.Data),this._prepareUserTypesForm(e.Data)):this._globalFunctions.successErrorHandling(e,this,!0),this.isLoading=!1},e=>{this._globalFunctions.errorHanding(e,this,!0),this.isLoading=!1})}validateNotificationObj(){return this.userTypesForm.value.notificationid&&""!==this.userTypesForm.value.notificationid?!(!this.userTypesForm.value.usertype||""===this.userTypesForm.value.usertype)||(this._sNotify.error("Select Business Type!","Oops!"),!1):(this._sNotify.error("Notification Id is required!","Oops!"),!1)}next(){if(this.isLoading||!this.validateNotificationObj())return!1;this.isLoading=!0,this._promoteService.saveUserType(this.userTypesForm.value).subscribe(e=>{e&&e.IsSuccess?(this._globalService.promoteNotification$.next(e.Data),this._sNotify.success("User Type Selected Successfully.","Success"),this._router.navigate(["/notifications/promote/users"]),this.isLoading=!1):(this._globalFunctions.successErrorHandling(e,this,!0),this.isLoading=!1)},e=>{this._globalFunctions.errorHanding(e,this,!0),this.isLoading=!1})}_prepareUserTypesForm(e={}){this.userTypesForm=this._formBuilder.group({notificationid:[this.nId,[a.kI.required]],usertype:[e?.usertype||"",[a.kI.required]]})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(a.qu),t.Y36(_.VZ),t.Y36(b),t.Y36(m.F0),t.Y36(f.E),t.Y36(x.U))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-user-types"]],decls:17,vars:2,consts:[[1,""],[1,"flex","flex-wrap","justify-start","pt-4",3,"formGroup"],["class","w-1/2 lg:w-1/3 xl:w-1/4 p-3 group",4,"ngFor","ngForOf"],[1,"mt-auto"],[1,"w-full","mt-5","addsBox"],["src","/assets/images/banner-ads.png","alt","ring-ad",1,"w-full","object-cover"],[1,"prw-next-btn","mt-auto"],["type","button",1,"flex","items-center"],[1,"icon-left_arrow","mr-3"],["type","button",1,"flex","items-center","active",3,"click"],[1,"icon-right_arrow","ml-3"],[1,"w-1/2","lg:w-1/3","xl:w-1/4","p-3","group"],[1,"user_type","text-center","bg-white","rounded","flex","flex-col","justify-between","items-center","h-full","px-5","py-7","anim","relative","group","cursor-pointer",3,"id"],["type","radio","name","user_type","formControlName","usertype",1,"hidden",3,"id","value"],[1,"absolute","inset-0","border-2","border-magicPotion","opacity-0","anim"],[1,"w-32","h-32"],[1,"w-full","h-full","object-contain",3,"src","alt"],[1,"text-base","font-bold","pt-8","whitespace-nowrap"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"h3"),t._uU(2,"Select Business"),t.qZA(),t.TgZ(3,"form",1),t.YNc(4,O,8,6,"div",2),t.qZA()(),t.TgZ(5,"div",3)(6,"div",4),t._UZ(7,"img",5),t.qZA(),t.TgZ(8,"div",6)(9,"button",7),t._UZ(10,"i",8),t.TgZ(11,"h5"),t._uU(12,"Back"),t.qZA()(),t.TgZ(13,"button",9),t.NdJ("click",function(){return i.next()}),t.TgZ(14,"h5"),t._uU(15,"Next"),t.qZA(),t._UZ(16,"i",10),t.qZA()()()),2&e&&(t.xp6(3),t.Q6J("formGroup",i.userTypesForm),t.xp6(1),t.Q6J("ngForOf",i.constants.userTypeArr))},dependencies:[d.sg,a._Y,a.Fj,a._,a.JJ,a.JL,a.sg,a.u],styles:[".user_type[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]:checked + span[_ngcontent-%COMP%]{opacity:1}.user_type[_ngcontent-%COMP%] > input[_ngcontent-%COMP%]:checked ~ p[_ngcontent-%COMP%]{--tw-text-opacity: 1;color:rgb(254 77 95 / var(--tw-text-opacity))}"]}),o})();var g=r(7489),U=r(7932);function j(o,s){if(1&o&&(t.TgZ(0,"option",17),t._uU(1),t.qZA()),2&o){const e=s.index,i=t.oxw(2);t.Q6J("value",e?e*i.math.ceil(i.totalUsersCount/10):i.totalUsersCount),t.xp6(1),t.Oqu(e?e*i.math.ceil(i.totalUsersCount/10):"Select All")}}function w(o,s){if(1&o&&(t.TgZ(0,"div",10)(1,"div",11)(2,"h5",12),t._uU(3,"Select User"),t.qZA(),t.TgZ(4,"select",13),t.YNc(5,j,2,2,"option",14),t.qZA()(),t.TgZ(6,"div",15)(7,"span",16),t._uU(8),t.qZA()()()),2&o){const e=t.oxw();t.xp6(4),t.Q6J("formControlName","numberofusers"),t.xp6(1),t.Q6J("ngForOf",e.totalOptions),t.xp6(3),t.hij("Total User : ",e.totalUsersCount,"")}}function I(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",33)(1,"div")(2,"div",34),t._UZ(3,"img",35),t.qZA(),t.TgZ(4,"label",36)(5,"div",37)(6,"div",38)(7,"input",39),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.onPromotionPlanClick())}),t.qZA(),t._UZ(8,"i",40),t.qZA(),t.TgZ(9,"span",41),t._uU(10),t.qZA()(),t.TgZ(11,"div",42)(12,"div",43)(13,"span",44),t._uU(14,"Notification"),t.qZA(),t.TgZ(15,"span",44),t._uU(16),t.ALo(17,"number"),t.ALo(18,"number"),t.qZA()(),t.TgZ(19,"div",43)(20,"span",44),t._uU(21,"SMS"),t.qZA(),t.TgZ(22,"span",44),t._uU(23),t.ALo(24,"number"),t.ALo(25,"number"),t.qZA()(),t.TgZ(26,"div",43)(27,"span",44),t._uU(28,"Email"),t.qZA(),t.TgZ(29,"span",44),t._uU(30),t.ALo(31,"number"),t.ALo(32,"number"),t.qZA()(),t.TgZ(33,"div",43)(34,"span",44),t._uU(35,"All"),t.qZA(),t.TgZ(36,"span",44),t._uU(37),t.ALo(38,"number"),t.ALo(39,"number"),t.qZA()()()()()()}if(2&o){const e=s.$implicit,i=s.index;t.xp6(1),t.Gre("bg-gradient-to-r ",i?1==i?"from-[#20c0e878] to-[#20C0E8]":"from-[#faba1585] to-[#FABA15]":"from-[#13e1b094] to-[#13E1B0]"," p-5 rounded-xl relative overflow-hidden cursor-pointer"),t.xp6(3),t.Q6J("for","promotion-plan"+i),t.xp6(3),t.Q6J("id","promotion-plan"+i)("value",e._id)("formControlName","selected_plan"),t.xp6(3),t.Oqu(e.planname),t.xp6(6),t.AsE("",t.xi3(17,16,e.notification_amount,"1.2-2")," FOR ",t.xi3(18,19,e.total_users,"1.0-0")," USERS"),t.xp6(7),t.AsE("",t.xi3(24,22,e.sms_amount,"1.2-2")," FOR ",t.xi3(25,25,e.total_users,"1.0-0")," USERS"),t.xp6(7),t.AsE("",t.xi3(31,28,e.email_amount,"1.2-2")," FOR ",t.xi3(32,31,e.total_users,"1.0-0")," USERS"),t.xp6(7),t.AsE("",t.xi3(38,34,e.combo_amount,"1.2-2")," FOR ",t.xi3(39,37,e.total_users,"1.0-0")," USERS")}}function S(o,s){if(1&o&&(t.TgZ(0,"option",17),t._uU(1),t.qZA()),2&o){const e=s.index,i=t.oxw(2);t.Q6J("value",e?100*e:i.totalUsersCount),t.xp6(1),t.Oqu(e?100*e:"Select All")}}function N(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"div",18)(2,"h5"),t._uU(3,"Select User Plan"),t.qZA(),t.TgZ(4,"div",19),t.YNc(5,I,40,40,"div",20),t.qZA()(),t.TgZ(6,"h2",21)(7,"small",22),t._uU(8,"OR"),t.qZA()(),t.TgZ(9,"div")(10,"div",23)(11,"div",24)(12,"h5",25),t._uU(13,"Select All App User"),t.qZA(),t.TgZ(14,"select",26),t.NdJ("change",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.onChangeUserSelection())}),t.YNc(15,S,2,2,"option",14),t.qZA()(),t.TgZ(16,"div",27)(17,"span",16),t._uU(18),t.qZA()()(),t.TgZ(19,"div",28)(20,"div",24)(21,"h5",25),t._uU(22,"ads publish location"),t.qZA(),t.TgZ(23,"div",29),t._UZ(24,"input",30),t.TgZ(25,"a",31),t._UZ(26,"i",32),t.qZA()()()()()()}if(2&o){const e=t.oxw();t.xp6(5),t.Q6J("ngForOf",e.allPromotionPlans),t.xp6(9),t.Q6J("formControlName","numberofusers"),t.xp6(1),t.Q6J("ngForOf",e.totalOptions),t.xp6(3),t.hij("Total User : ",e.totalUsersCount,""),t.xp6(6),t.Q6J("formControlName","published_location")}}const F=function(){return{width:"50px",height:"50px"}};function L(o,s){1&o&&t._UZ(0,"p-progressSpinner",66),2&o&&t.Akn(t.DdM(2,F))}function q(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",67)(1,"label",68)(2,"input",69),t.NdJ("change",function(){const n=t.CHM(e),l=n.$implicit,c=n.index,p=t.oxw(2);return t.KtG(p.onCheckboxChange(l,c))}),t.qZA(),t._UZ(3,"i",52),t.qZA(),t.TgZ(4,"div",70)(5,"div",71),t._UZ(6,"img",72),t.qZA(),t.TgZ(7,"span",73),t._uU(8),t.qZA()()()}if(2&o){const e=s.$implicit,i=s.index,n=t.oxw(2);t.xp6(2),t.Q6J("id","user-"+i)("checked",e.selected),t.xp6(4),t.Q6J("src",e.Photo&&""!=e.Photo?e.Photo:n.constants.defaultImage,t.LSH)("alt",null==e?null:e.FullName),t.xp6(2),t.Oqu(null==e?null:e.FullName)}}function D(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",74)(1,"button",75),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.getImportedUsersList())}),t._uU(2,"Load more"),t.qZA()()}}function P(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"h5"),t._uU(2,"Select User"),t.qZA(),t.TgZ(3,"div",45)(4,"div",46)(5,"div",47),t.YNc(6,L,1,3,"p-progressSpinner",48),t.TgZ(7,"div",49)(8,"label",50)(9,"input",51),t.NdJ("click",function(n){t.CHM(e);const l=t.oxw();return t.KtG(l.onSelectAllChecked(n))}),t.qZA(),t._UZ(10,"i",52),t.qZA(),t.TgZ(11,"span",53),t._uU(12,"Select All"),t.qZA()(),t.YNc(13,q,9,5,"div",54),t.YNc(14,D,3,0,"div",55),t.qZA()(),t.TgZ(15,"div",56)(16,"div",57),t._uU(17,"Total User: "),t.TgZ(18,"span"),t._uU(19),t.ALo(20,"number"),t.qZA()(),t.TgZ(21,"div",58)(22,"div",59)(23,"h5"),t._uU(24,"Upload Excel"),t.qZA(),t.TgZ(25,"a",60),t._uU(26,"Demo"),t.qZA()(),t.TgZ(27,"label",61)(28,"input",62),t.NdJ("change",function(n){t.CHM(e);const l=t.oxw();return t.KtG(l.uploadUserCSV(n))}),t.qZA(),t.TgZ(29,"div",63),t._UZ(30,"i",64),t.TgZ(31,"span",65),t._uU(32,"Upload Excel"),t.qZA()()()()()()()}if(2&o){const e=t.oxw();t.xp6(6),t.Q6J("ngIf",e.isLoading),t.xp6(3),t.Q6J("formControlName","is_selected_all"),t.xp6(4),t.Q6J("ngForOf",e.allImportedUsers),t.xp6(1),t.Q6J("ngIf",e.pageObj&&e.pageObj.hasNextPage),t.xp6(5),t.Oqu(t.xi3(20,6,e.totalUsersCount,"1.0-0")),t.xp6(6),t.Q6J("href",e.constants.baseImageURL+e.constants.importUsersDemoUrl,t.LSH)}}let k=(()=>{class o{constructor(e,i,n,l,c,p){this._formBuilder=e,this._sNotify=i,this._promoteService=n,this._router=l,this._globalFunctions=c,this._globalService=p,this.notificationObj={},this.allPromotionPlans=[],this.allImportedUsers=[],this.isAllUserSelected=!1,this.isExistingUserSelected=!1,this.isUploadCSVLoading=!1,this.isLoading=!1,this.constants=h.t,this.tmpSelectedPlan="",this.totalUsersCount=0,this.pageObj={},this.math=Math}get totalOptions(){return new Array(this.totalUsersCount?Math.ceil(this.totalUsersCount/Math.ceil(this.totalUsersCount/10)):0)}ngOnInit(){this.nId=localStorage.getItem("nId"),this.nId&&""!=this.nId?(this._prepareUsersForm(),this.notificationObj=this._globalService.promoteNotification$.getValue(),this.notificationObj&&this.notificationObj._id&&""!=this.notificationObj._id?(this._prepareVariables(this.notificationObj),this._prepareUsersForm(this.notificationObj)):this.getNotificationById()):this._router.navigate(["notifications"])}_prepareVariables(e={}){e&&e.usertype&&(e.usertype==h.t.userTypeArr[h.t.userType.ALL_USERS].value?(this.isAllUserSelected=!0,this.getPromotionPlans()):e.usertype==h.t.userTypeArr[h.t.userType.EXISTING_USERS].value&&(this.isExistingUserSelected=!0,this.getImportedUsersList()))}getNotificationById(){this.isLoading=!0,this._promoteService.getNotificationById(this.nId).subscribe(e=>{e&&e.IsSuccess?(this.notificationObj=this._globalFunctions.copyObject(e.Data),this._globalService.promoteNotification$.next(e.Data),this._prepareVariables(e.Data),this._prepareUsersForm(e.Data),this.isLoading=!1):(this._globalFunctions.successErrorHandling(e,this,!0),this.isLoading=!1)},e=>{this._globalFunctions.errorHanding(e,this,!0),this.isLoading=!1})}getPromotionPlans(){this.isLoading=!0,this._promoteService.getPromotionPlans().subscribe(e=>{e&&e.IsSuccess?(this.allPromotionPlans=e.Data,this.isLoading=!1):(this._globalFunctions.successErrorHandling(e,this,!0),this.isLoading=!1)},e=>{this._globalFunctions.errorHanding(e,this,!0),this.isLoading=!1})}getImportedUsersList(){this.isLoading=!0,this._promoteService.getImportedUsersList({notificationid:this.nId,page:this.pageObj?.nextPage||1,limit:this.pageObj?.limit||6,search:""}).subscribe(i=>{i&&i.IsSuccess?(this.allImportedUsers=this.allImportedUsers&&this.allImportedUsers.length?g.concat(...this.allImportedUsers,i.Data.docs):this._globalFunctions.copyObject(i.Data.docs),this.pageObj=this._globalFunctions.copyObject(i.Data),this.totalUsersCount=this.pageObj.totalDocs,delete this.pageObj.docs,this.isLoading=!1):(this._globalFunctions.successErrorHandling(i,this,!0),this.isLoading=!1)},i=>{this._globalFunctions.errorHanding(i,this,!0),this.isLoading=!1})}uploadUserCSV(e){if(e.target.files&&e.target.files[0]){this.isUploadCSVLoading=!0;const i=e.target.files[0];if("text/csv"!=i.type&&"text/xml"!=i.type&&"text/xls"!=i.type&&"text/xlsx"!=i.type)return this._sNotify.error("File type is Invalid.","Oops!"),!1;const n=new FormData;n.append("file",i),n.append("notificationid",this.nId),this._promoteService.importUsersCSV(n).subscribe(l=>{l&&l.IsSuccess?(l.Data.rejectedCount&&l.Data.importCount>0&&this._sNotify.success(l.Data.importCount+" Number of user records uploaded successfully.","Success"),l.Data.rejectedCount&&l.Data.rejectedCount>0&&this._sNotify.error(l.Data.rejectedCount+" Number of user records rejected.","Oops"),this.pageObj={},this.allImportedUsers=[],this.getImportedUsersList(),this.isUploadCSVLoading=!1):(this._globalFunctions.successErrorHandling(l,this,!0),this.isUploadCSVLoading=!1)},l=>{this._globalFunctions.errorHanding(l,this,!0),this.isUploadCSVLoading=!1})}}onSelectAllChecked(e){if(this.allImportedUsers&&this.allImportedUsers.length){this.isLoading=!0;const i=e&&e.target&&e.target.checked;this._promoteService.checkAllUser({notificationid:this.nId,is_selected_all:i}).subscribe(l=>{l&&l.IsSuccess?(this.allImportedUsers=g.map(this.allImportedUsers,c=>({...c,selected:i})),e&&e.target&&e.target.checked?localStorage.setItem("selectAll","true"):localStorage.removeItem("selectAll"),this.isLoading=!1):(this._globalFunctions.successErrorHandling(l,this,!0),this.isLoading=!1)},l=>{this._globalFunctions.errorHanding(l,this,!0),this.isLoading=!1})}}onCheckboxChange(e,i){if(e&&e._id){this.isLoading=!0;const n={notificationid:this.nId,userid:e._id,selected:!e.selected};this._promoteService.checkUser(n).subscribe(l=>{if(l&&l.IsSuccess){const c=this._globalFunctions.copyObject(this.allImportedUsers);c[i].selected=!e.selected,this.allImportedUsers=this._globalFunctions.copyObject(c),n.selected||(this.usersForm.get("is_selected_all").setValue(!1),localStorage.removeItem("selectAll")),this.isLoading=!1}else this._globalFunctions.successErrorHandling(l,this,!0),this.isLoading=!1},l=>{this._globalFunctions.errorHanding(l,this,!0),this.isLoading=!1})}}validateUsersObj(e={}){if(this.isAllUserSelected){if(!(e.selected_plan&&""!=e.selected_plan||e.numberofusers&&!(Number(e?.numberofusers||0)<=0)||e.published_location&&""!=e.published_location))return this._sNotify.error("You have to select plan or select app users and ads publish location","Oops"),!1;if((!e.selected_plan||""==e.selected_plan)&&e.numberofusers&&Number(e?.numberofusers||0)>0&&(!e.published_location||""==e.published_location))return this._sNotify.error("Ads publish location is required","Oops"),!1;if((!e.selected_plan||""==e.selected_plan)&&(!e.numberofusers||Number(e?.numberofusers||0)<=0)&&e.published_location&&""!=e.published_location)return this._sNotify.error("Please select app users","Oops"),!1}return!0}prepareUsersObj(e={}){const i=this._globalFunctions.copyObject(e);return this.isAllUserSelected?(i.selected_plan?(i.published_location="",i.numberofusers=""):i.selected_plan="",i.is_selected_all=""):this.isExistingUserSelected?(i.numberofusers="",i.published_location="",i.selected_plan=""):(i.is_selected_all="",i.selected_plan="",i.published_location=""),i}onNextClick(){if(this.isLoading||!this.validateUsersObj(this.usersForm.value))return!1;const e=this.prepareUsersObj(this.usersForm.value);this.isLoading=!0,this._promoteService.saveUsers(e).subscribe(i=>{i&&i.IsSuccess?(this._globalService.promoteNotification$.next(i.Data),this._sNotify.success("User Selected Successfully.","Success"),this._router.navigate(["/notifications/promote/publish-date-and-time"]),this.isLoading=!1):(this._globalFunctions.successErrorHandling(i,this,!0),this.isLoading=!1)},i=>{this._globalFunctions.errorHanding(i,this,!0),this.isLoading=!1})}onBackClick(){this._router.navigate(["/notifications/promote/user-type"])}onPromotionPlanClick(){setTimeout(()=>{this.usersForm.value.selected_plan&&this.usersForm.value.selected_plan==this.tmpSelectedPlan?(this.usersForm.get("selected_plan").setValue(""),this.tmpSelectedPlan=""):(this.tmpSelectedPlan=this.usersForm.value.selected_plan,this.usersForm.get("numberofusers").setValue(""),this.usersForm.get("published_location").setValue(""))},0)}onChangeUserSelection(){this.usersForm.get("selected_plan").setValue(""),this.tmpSelectedPlan=""}_prepareUsersForm(e={}){this.usersForm=this._formBuilder.group({notificationid:[this.nId,[a.kI.required]],numberofusers:[e?.numberofusers||this.totalUsersCount.toString()],published_location:[e?.published_location||""],selected_plan:[e?.selected_plan||""],is_selected_all:[e?.is_selected_all||!1]}),this.allImportedUsers&&this.allImportedUsers.length&&!localStorage.getItem("selectAll")&&(this.allImportedUsers=g.map(this.allImportedUsers,i=>({...i,selected:!1})))}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(a.qu),t.Y36(_.VZ),t.Y36(b),t.Y36(m.F0),t.Y36(f.E),t.Y36(x.U))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-users"]],decls:16,vars:4,consts:[[1,"",3,"formGroup"],["class","flex flex-wrap items-end justify-between ",4,"ngIf"],[4,"ngIf"],[1,"mt-auto"],[1,"w-full","mt-5","addsBox"],["src","/assets/images/banner-ads.png","alt","ring-ad",1,"w-full","object-cover"],[1,"prw-next-btn","mt-auto"],["type","button",1,"flex","items-center","active",3,"click"],[1,"icon-left_arrow","mr-3"],[1,"icon-right_arrow","ml-3"],[1,"flex","flex-wrap","items-end","justify-between"],[1,"w-full","lg:w-1/2"],[1,"pb-3"],[1,"bg-white","rounded-md","flex","space-x-3","outline-0","px-6","py-[18px]","relative","arrow","option",3,"formControlName"],[3,"value",4,"ngFor","ngForOf"],[1,"bg-white","p-[18px]","rounded-md","mt-5","lg:mt-0"],[1,"text-base","font-bold","text-japaneseIndigo"],[3,"value"],[1,""],[1,"flex","flex-wrap","xl:flex-nowrap","justify-between","xl:space-x-5","items-center","py-5"],["class","w-full xl:w-1/3 pb-5 xl:pb-0",4,"ngFor","ngForOf"],[1,"border-t-2","border-gray-400","border-dashed","text-center","relative","my-10"],[1,"text-japaneseIndigo","py-1","px-10","absolute","-mt-5","bg-brightGray"],[1,"flex","items-end","justify-between"],[1,"w-1/2"],[1,"pb-3","capitalize"],[1,"bg-white","rounded-md","flex","space-x-3","outline-0","px-6","py-[18px]","relative","arrow","option",3,"formControlName","change"],[1,"bg-white","p-[18px]","rounded-md"],[1,"flex","pt-7"],[1,"flex","items-center","justify-between","inputHolder","bg-white","rounded-md","px-5","py-3"],["type","text","name","published_location","id","published_location",1,"input","text-base","font-bold","text-japaneseIndigo","w-full",3,"formControlName"],["href","javascript:void(0);"],[1,"icon-mark_location","text-magicPotion","text-3xl"],[1,"w-full","xl:w-1/3","pb-5","xl:pb-0"],[1,"absolute","-left-3","-bottom-3"],["src","../assets/images/event-subscription.png","alt","celebration"],[1,"cursor-pointer","relative",3,"for"],[1,"flex","items-center"],[1,"radio"],["type","radio","name","promotion-plan-card",1,"radio",3,"id","value","formControlName","click"],[1,"icon-right","text-white"],[1,"text-xl","font-normal","text-white","ml-5"],[1,"pt-7","space-y-3"],[1,"flex","w-full","justify-between","items-center"],[1,"text-sm","text-japaneseIndigo","font-bold"],[1,"flex","flex-wrap","lg:flex-nowrap","lg:space-x-12","pt-5"],[1,"w-full","lg:w-1/2","relative"],[1,"space-y-3","max-h-[540px]","overflow-y-auto"],["animationDuration",".5s","strokeWidth","8","class","absolute bg-white bg-opacity-25 backdrop-blur-sm inset-x-0 top-0 h-full w-full z-40","styleClass","custom-spinner absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",3,"style",4,"ngIf"],[1,"flex","items-center","bg-white","rounded-md","cursor-pointer","w-full","px-4","py-3","sticky","top-0","z-10","shadow"],["for","is_selected_all",1,"checkbox","w-8","h-8"],["type","checkbox","name","is_selected_all","id","is_selected_all",1,"bgbrightgray",3,"formControlName","click"],[1,"icon-right","text-10","text-white"],[1,"text-base","text-japaneseIndigo","font-bold","ml-4"],["class","flex items-center bg-white rounded-md cursor-pointer w-full px-4 py-3",4,"ngFor","ngForOf"],["class","text-center",4,"ngIf"],[1,"w-full","lg:w-1/2","pt-5","lg:pt-0"],[1,"max-w-max","ml-auto","text-base","font-bold","text-japaneseIndigo","bg-white","py-3","px-8","rounded-md"],[1,"upload-holder","w-full","h-full","pt-5"],[1,"flex","items-end","justify-between","pb-3"],["target","_self",1,"secondary","px-5","py-2",3,"href"],["for","upload-csv",1,"upload","py-14"],["type","file","accept","text/csv, text/xml, text/xls, text/xlsx","name","upload-csv","id","upload-csv",1,"appearance-none","hidden",3,"change"],[1,"mt-1","flex","items-center","justify-center"],[1,"icon-excel","text-quicksilver","text-base","mr-2"],[1,"input-titel","pt-1"],["animationDuration",".5s","strokeWidth","8","styleClass","custom-spinner absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",1,"absolute","bg-white","bg-opacity-25","backdrop-blur-sm","inset-x-0","top-0","h-full","w-full","z-40"],[1,"flex","items-center","bg-white","rounded-md","cursor-pointer","w-full","px-4","py-3"],[1,"checkbox","w-8","h-8"],["type","checkbox",1,"bgbrightgray",3,"id","checked","change"],[1,"flex","items-center","ml-4"],[1,"w-8","h-8","rounded-full","overflow-hidden","mr-4"],[1,"w-full","h-full","object-cover",3,"src","alt"],[1,"text-base","text-japaneseIndigo","font-bold"],[1,"text-center"],[1,"secondary","px-5","py-2",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"form",0),t.YNc(1,w,9,3,"div",1),t.YNc(2,N,27,5,"div",2),t.YNc(3,P,33,9,"div",2),t.qZA(),t.TgZ(4,"div",3)(5,"div",4),t._UZ(6,"img",5),t.qZA(),t.TgZ(7,"div",6)(8,"button",7),t.NdJ("click",function(){return i.onBackClick()}),t._UZ(9,"i",8),t.TgZ(10,"h5"),t._uU(11,"Back"),t.qZA()(),t.TgZ(12,"button",7),t.NdJ("click",function(){return i.onNextClick()}),t.TgZ(13,"h5"),t._uU(14,"Next"),t.qZA(),t._UZ(15,"i",9),t.qZA()()()),2&e&&(t.Q6J("formGroup",i.usersForm),t.xp6(1),t.Q6J("ngIf",!i.isAllUserSelected&&!i.isExistingUserSelected),t.xp6(1),t.Q6J("ngIf",i.isAllUserSelected),t.xp6(1),t.Q6J("ngIf",i.isExistingUserSelected))},dependencies:[d.sg,d.O5,a._Y,a.YN,a.Kr,a.Fj,a.Wl,a.EJ,a._,a.JJ,a.JL,a.sg,a.u,U.G,d.JJ],styles:[".checkbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .p-checkbox[_ngcontent-%COMP%]   .p-checkbox-box[_ngcontent-%COMP%]{width:24px;height:24px}"]}),o})();var J=r(5439),Z=r(585);function E(o,s){if(1&o&&(t.TgZ(0,"span",24),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.AsE("",e.numberOfUsers," User x ",null==e.settingObj?null:e.settingObj.notificationcost,"")}}function Y(o,s){if(1&o&&(t.TgZ(0,"span",24),t._uU(1),t.ALo(2,"number"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.AsE("",t.xi3(2,2,e.selectedPlanObj.notification_amount,"1.2-2")," FOR ",t.xi3(3,5,e.selectedPlanObj.total_users,"1.0-0")," USERS")}}function H(o,s){if(1&o&&(t.TgZ(0,"div",17),t._UZ(1,"i",18),t.TgZ(2,"div",19)(3,"div",0)(4,"p",20),t._uU(5,"Notification"),t.qZA(),t.YNc(6,E,2,2,"span",21),t.YNc(7,Y,4,8,"span",21),t.qZA(),t.TgZ(8,"h4",22),t._UZ(9,"i",23),t._uU(10),t.ALo(11,"number"),t.qZA()()()),2&o){const e=t.oxw();t.xp6(6),t.Q6J("ngIf",e.calculateTotalObj.planDiscount),t.xp6(1),t.Q6J("ngIf",!e.calculateTotalObj.planDiscount),t.xp6(3),t.Oqu(t.xi3(11,3,(null==e.calculateTotalObj?null:e.calculateTotalObj.notificationTotal)||0,"1.2-2"))}}function Q(o,s){if(1&o&&(t.TgZ(0,"span",24),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.AsE("",e.numberOfUsers," Phone Number x ",null==e.settingObj?null:e.settingObj.smscost,"")}}function z(o,s){if(1&o&&(t.TgZ(0,"span",24),t._uU(1),t.ALo(2,"number"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.AsE("",t.xi3(2,2,e.selectedPlanObj.sms_amount,"1.2-2")," FOR ",t.xi3(3,5,e.selectedPlanObj.total_users,"1.0-0")," USERS")}}function M(o,s){if(1&o&&(t.TgZ(0,"div",17),t._UZ(1,"i",25),t.TgZ(2,"div",19)(3,"div",0)(4,"p",20),t._uU(5,"SMS"),t.qZA(),t.YNc(6,Q,2,2,"span",21),t.YNc(7,z,4,8,"span",21),t.qZA(),t.TgZ(8,"h4",22),t._UZ(9,"i",23),t._uU(10),t.ALo(11,"number"),t.qZA()()()),2&o){const e=t.oxw();t.xp6(6),t.Q6J("ngIf",e.calculateTotalObj.planDiscount),t.xp6(1),t.Q6J("ngIf",!e.calculateTotalObj.planDiscount),t.xp6(3),t.Oqu(t.xi3(11,3,(null==e.calculateTotalObj?null:e.calculateTotalObj.smsTotal)||0,"1.2-2"))}}function R(o,s){if(1&o&&(t.TgZ(0,"span",24),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.AsE("",e.numberOfUsers," Email ID x ",null==e.settingObj?null:e.settingObj.emailcost,"")}}function V(o,s){if(1&o&&(t.TgZ(0,"span",24),t._uU(1),t.ALo(2,"number"),t.ALo(3,"number"),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.AsE("",t.xi3(2,2,e.selectedPlanObj.email_amount,"1.2-2")," FOR ",t.xi3(3,5,e.selectedPlanObj.total_users,"1.0-0")," USERS")}}function G(o,s){if(1&o&&(t.TgZ(0,"div",17),t._UZ(1,"i",26),t.TgZ(2,"div",19)(3,"div",0)(4,"p",20),t._uU(5,"Email"),t.qZA(),t.YNc(6,R,2,2,"span",21),t.YNc(7,V,4,8,"span",21),t.qZA(),t.TgZ(8,"h4",22),t._UZ(9,"i",23),t._uU(10),t.ALo(11,"number"),t.qZA()()()),2&o){const e=t.oxw();t.xp6(6),t.Q6J("ngIf",e.calculateTotalObj.planDiscount),t.xp6(1),t.Q6J("ngIf",!e.calculateTotalObj.planDiscount),t.xp6(3),t.Oqu(t.xi3(11,3,(null==e.calculateTotalObj?null:e.calculateTotalObj.emailTotal)||0,"1.2-2"))}}function $(o,s){if(1&o&&(t.TgZ(0,"div",17),t._UZ(1,"i",26),t.TgZ(2,"div",19)(3,"div",0)(4,"p",20),t._uU(5,"All"),t.qZA(),t.TgZ(6,"span",24),t._uU(7),t.ALo(8,"number"),t.ALo(9,"number"),t.qZA()(),t.TgZ(10,"h4",22),t._UZ(11,"i",23),t._uU(12),t.ALo(13,"number"),t.qZA()()()),2&o){const e=t.oxw();t.xp6(7),t.AsE("",t.xi3(8,3,e.selectedPlanObj.combo_amount,"1.2-2")," FOR ",t.xi3(9,6,e.selectedPlanObj.total_users,"1.0-0")," USERS"),t.xp6(5),t.Oqu(t.xi3(13,9,(null==e.selectedPlanObj?null:e.selectedPlanObj.combo_amount)||0,"1.2-2"))}}function K(o,s){if(1&o&&(t.TgZ(0,"div",27)(1,"h5"),t._uU(2,"discount savings"),t.qZA(),t.TgZ(3,"h4"),t._uU(4,"- "),t._UZ(5,"i",23),t._uU(6),t.ALo(7,"number"),t.qZA()()),2&o){const e=t.oxw();t.xp6(6),t.Oqu(t.xi3(7,1,(null==e.calculateTotalObj?null:e.calculateTotalObj.totalCouponDiscount)||0,"1.2-2"))}}function X(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",32)(1,"div")(2,"h5",33),t._uU(3),t.ALo(4,"number"),t.qZA(),t.TgZ(5,"span",34),t._uU(6),t.qZA()(),t.TgZ(7,"div")(8,"a",35),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.onRemoveCoupon())}),t._UZ(9,"i",36),t.qZA()()()}if(2&o){const e=t.oxw(3);t.xp6(3),t.hij("Coupon applied - You saved \u20b9",t.xi3(4,2,(null==e.calculateTotalObj?null:e.calculateTotalObj.totalCouponDiscount)||0,"1.2-2"),""),t.xp6(3),t.hij("Coupon Code : ",null==e.selectedCoupon?null:e.selectedCoupon.code,"")}}function W(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",37),t._UZ(1,"i",38),t.TgZ(2,"div",19)(3,"div",0)(4,"p",20),t._uU(5,"Apply Coupons"),t.qZA(),t._UZ(6,"span",39),t.qZA(),t.TgZ(7,"div",40)(8,"button",41),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,l=t.oxw(2);return t.KtG(l.onApplyCoupon(n))}),t._uU(9," Apply Code "),t.qZA()()()()}if(2&o){const e=t.oxw().$implicit;t.xp6(6),t.Q6J("innerHTML",(null==e?null:e.description)||"",t.oJD)}}function tt(o,s){if(1&o&&(t.TgZ(0,"div"),t.YNc(1,X,10,5,"div",30),t.YNc(2,W,10,1,"div",31),t.qZA()),2&o){const e=s.$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("ngIf",i.selectedCoupon&&i.selectedCoupon._id&&i.selectedCoupon._id==e._id),t.xp6(1),t.Q6J("ngIf",!i.selectedCoupon||!i.selectedCoupon._id||i.selectedCoupon._id!=e._id)}}function et(o,s){if(1&o&&(t.TgZ(0,"div",0)(1,"h5",28),t._uU(2,"discount coupon"),t.qZA(),t.YNc(3,tt,3,2,"div",29),t.qZA()),2&o){const e=t.oxw();t.xp6(3),t.Q6J("ngForOf",e.couponsList)}}const it=[{path:"",component:y,children:[{path:"user-type",component:A},{path:"users",component:k},{path:"publish-date-and-time",component:(()=>{class o{constructor(e,i,n,l,c,p){this._formBuilder=e,this._sNotify=i,this._promoteService=n,this._router=l,this._globalFunctions=c,this._globalService=p,this.notificationObj={},this.isLoading=!1,this.minDateValue=new Date}ngOnInit(){this.nId=localStorage.getItem("nId"),this.nId&&""!=this.nId?(this._prepareDateAndTimeForm(),this.notificationObj=this._globalService.promoteNotification$.getValue(),this.notificationObj&&this.notificationObj._id&&""!=this.notificationObj._id?this._prepareDateAndTimeForm(this.notificationObj):this.getNotificationById()):this._router.navigate(["notifications"])}getNotificationById(){this.isLoading=!0,this._promoteService.getNotificationById(this.nId).subscribe(e=>{e&&e.IsSuccess?(this._globalService.promoteNotification$.next(e.Data),this._prepareDateAndTimeForm(e.Data)):this._globalFunctions.successErrorHandling(e,this,!0),this.isLoading=!1},e=>{this._globalFunctions.errorHanding(e,this,!0),this.isLoading=!1})}validateDateAndTimeObj(){return this.dateAndTimeForm.value.notification_date&&""!=this.dateAndTimeForm.value.notification_date?this.dateAndTimeForm.value.notification_time&&""!=this.dateAndTimeForm.value.notification_time?!!(this.dateAndTimeForm.value.is_notification||this.dateAndTimeForm.value.is_email||this.dateAndTimeForm.value.is_sms)||(this._sNotify.error("Please select at least one category!","Oops!"),!1):(this._sNotify.error("Notification Time is required!","Oops!"),!1):(this._sNotify.error("Notification Date is required!","Oops!"),!1)}onNextClick(){if(this.isLoading||!this.validateDateAndTimeObj())return!1;const e=this.prepareDateAndTimeObj(this.dateAndTimeForm.value);this.isLoading=!0,this._promoteService.saveSchedule(e).subscribe(i=>{i&&i.IsSuccess?(this._globalService.promoteNotification$.next(i.Data),this._sNotify.success("Publish Date and Time Added Successfully.","Success"),this._router.navigate(["/notifications/promote/bill-details"]),this.isLoading=!1):(this._globalFunctions.successErrorHandling(i,this,!0),this.isLoading=!1)},i=>{this._globalFunctions.errorHanding(i,this,!0),this.isLoading=!1})}prepareDateAndTimeObj(e={}){const i=this._globalFunctions.copyObject(e);return i.notification_date=J(e.notification_date).format("YYYY-MM-DD"),i.notification_time=this.prepareTime(e.notification_time),i}prepareTime(e){return"Invalid Date"!=new Date(e)?e.getHours()+":"+e.getMinutes():e}onBackClick(){this._router.navigate(["/notifications/promote/users"])}_prepareDateAndTimeForm(e={}){this.dateAndTimeForm=this._formBuilder.group({notificationid:[this.nId,[a.kI.required]],notification_date:[e&&e.notification_date?new Date(e?.notification_date):""],notification_time:[e?.notification_time||""],is_notification:[e?.is_notification||!1],is_email:[e?.is_email||!1],is_sms:[e?.is_sms||!1]})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(a.qu),t.Y36(_.VZ),t.Y36(b),t.Y36(m.F0),t.Y36(f.E),t.Y36(x.U))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-publish-date-and-time"]],decls:47,vars:9,consts:[[1,"p-ngCss",3,"formGroup"],[1,"flex","flex-wrap","lg:pt-0","items-end","justify-between"],[1,"w-full","lg:w-1/2","lg:pr-3.5"],[1,"pb-3"],[1,"bg-white","rounded-md","flex","space-x-3","relative","cursor-text"],[1,"icon-calendar","flex","items-center","pl-5","absolute","left-0","inset-y-0","z-10"],["name","date","inputId","date",1,"left","w-full","rounded-md","outline-none","appearance-none","pl-10","py-2",3,"formControlName","minDate","readonlyInput"],[1,"w-full","lg:w-1/2","lg:pl-3.5","pt-5","lg:pt-0"],[1,"icon-time","flex","items-center","pl-5","absolute","left-0","inset-y-0"],["inputId","timeonly",1,"left","w-full","rounded-md","outline-none","appearance-none","pl-10","py-2",3,"timeOnly","formControlName"],[1,"mt-12"],[1,"pb-4"],[1,"flex","items-center","pb-7"],[1,"checkbox","w-8"],["type","checkbox","name","is_notification","id","is_notification",3,"formControlName"],[1,"icon-right","text-white"],[1,"text-base","font-bold","text-japaneseIndigo","pl-4"],["type","checkbox","name","is_sms","id","is_sms",3,"formControlName"],[1,"flex","items-center"],["type","checkbox","name","is_email","id","is_email",3,"formControlName"],[1,"mt-auto"],[1,"w-full","mt-5","addsBox"],["src","/assets/images/banner-ads.png","alt","ring-ad",1,"w-full","object-cover"],[1,"prw-next-btn","mt-auto"],["type","button",1,"flex","items-center","active",3,"click"],[1,"icon-left_arrow","mr-3"],[1,"icon-right_arrow","ml-3"]],template:function(e,i){1&e&&(t.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"h5",3),t._uU(4,"Date"),t.qZA(),t.TgZ(5,"label",4),t._UZ(6,"i",5)(7,"p-calendar",6),t.qZA()(),t.TgZ(8,"div",7)(9,"h5",3),t._uU(10,"Time"),t.qZA(),t.TgZ(11,"label",4),t._UZ(12,"i",8)(13,"p-calendar",9),t.qZA()()(),t.TgZ(14,"div",10)(15,"h5",11),t._uU(16,"Select category"),t.qZA(),t.TgZ(17,"div",12)(18,"label",13),t._UZ(19,"input",14)(20,"i",15),t.qZA(),t.TgZ(21,"span",16),t._uU(22,"Notification"),t.qZA()(),t.TgZ(23,"div",12)(24,"label",13),t._UZ(25,"input",17)(26,"i",15),t.qZA(),t.TgZ(27,"span",16),t._uU(28,"SMS"),t.qZA()(),t.TgZ(29,"div",18)(30,"label",13),t._UZ(31,"input",19)(32,"i",15),t.qZA(),t.TgZ(33,"span",16),t._uU(34,"Email"),t.qZA()()()(),t.TgZ(35,"div",20)(36,"div",21),t._UZ(37,"img",22),t.qZA(),t.TgZ(38,"div",23)(39,"button",24),t.NdJ("click",function(){return i.onBackClick()}),t._UZ(40,"i",25),t.TgZ(41,"h5"),t._uU(42,"Back"),t.qZA()(),t.TgZ(43,"button",24),t.NdJ("click",function(){return i.onNextClick()}),t.TgZ(44,"h5"),t._uU(45,"Next"),t.qZA(),t._UZ(46,"i",26),t.qZA()()()),2&e&&(t.Q6J("formGroup",i.dateAndTimeForm),t.xp6(7),t.Q6J("formControlName","notification_date")("minDate",i.minDateValue)("readonlyInput",!0),t.xp6(6),t.Q6J("timeOnly",!0)("formControlName","notification_time"),t.xp6(6),t.Q6J("formControlName","is_notification"),t.xp6(6),t.Q6J("formControlName","is_sms"),t.xp6(6),t.Q6J("formControlName","is_email"))},dependencies:[a._Y,a.Wl,a.JJ,a.JL,a.sg,a.u,Z.f],styles:[".p-ngCss[_ngcontent-%COMP%]     .p-inputtext{border:0!important}.p-ngCss[_ngcontent-%COMP%]     .p-inputtext:enabled:focus{border:0!important;box-shadow:none!important}"]}),o})()},{path:"bill-details",component:(()=>{class o{constructor(e,i,n,l,c,p){this._formBuilder=e,this._sNotify=i,this._promoteService=n,this._router=l,this._globalFunctions=c,this._globalService=p,this.notificationObj={},this.settingObj={},this.calculateTotalObj={},this.selectedPlanObj={},this.couponsList=[],this.isCouponLoading=!1,this.isLoading=!1,this.selectedCoupon="",this.numberOfUsers=0}ngOnInit(){this.nId=localStorage.getItem("nId"),this.nId&&""!=this.nId?(this._prepareBillDetailsForm(),this.notificationObj=this._globalService.promoteNotification$.getValue(),this.notificationObj&&this.notificationObj._id&&""!=this.notificationObj._id?this._prepareBillDetailsForm(this.notificationObj):this.getNotificationById(),this.getCoupons(),this.getSettings()):this._router.navigate(["notifications"])}getCoupons(){this.isCouponLoading=!0,this._promoteService.getCouponsList().subscribe(e=>{e&&e.IsSuccess?(this.couponsList=this._globalFunctions.copyObject(e.Data),this.isCouponLoading=!1):(this._globalFunctions.successErrorHandling(e,this,!0),this.isCouponLoading=!1)},e=>{this._globalFunctions.errorHanding(e,this,!0),this.isCouponLoading=!1})}getSettings(){this.isLoading=!0,this._promoteService.getSettings(this.nId).subscribe(e=>{e&&e.IsSuccess?(this.settingObj=this._globalFunctions.copyObject(e.Data?.settings[0]||{}),this.selectedPlanObj=this._globalFunctions.copyObject(e.Data?.planData||{}),this.numberOfUsers=e.Data.numberofusers,this.calculatePrice(),this.isLoading=!1):(this._globalFunctions.successErrorHandling(e,this,!0),this.isLoading=!1)},e=>{this._globalFunctions.errorHanding(e,this,!0),this.isLoading=!1})}calculatePrice(){const e=this.notificationObj&&this.notificationObj.is_notification,i=this.notificationObj&&this.notificationObj.is_sms,n=this.notificationObj&&this.notificationObj.is_email;if(this.calculateTotalObj.notificationTotal=e?Number(this.numberOfUsers)*Number(this.settingObj.notificationcost):0,this.calculateTotalObj.smsTotal=i?Number(this.numberOfUsers)*Number(this.settingObj.smscost):0,this.calculateTotalObj.emailTotal=n?Number(this.numberOfUsers)*Number(this.settingObj.emailcost):0,this.calculateTotalObj.subTotal=g.sum([this.calculateTotalObj.notificationTotal,this.calculateTotalObj.smsTotal,this.calculateTotalObj.emailTotal]),this.selectedPlanObj&&this.selectedPlanObj._id&&(this.calculateTotalObj.notificationTotal=e?this.selectedPlanObj.notification_amount:0,this.calculateTotalObj.smsTotal=i?this.selectedPlanObj.sms_amount:0,this.calculateTotalObj.emailTotal=n?this.selectedPlanObj.email_amount:0,this.calculateTotalObj.planDiscount=e&&i&&n,this.calculateTotalObj.subTotal=g.sum([this.calculateTotalObj.notificationTotal,this.calculateTotalObj.smsTotal,this.calculateTotalObj.emailTotal]),this.calculateTotalObj.planDiscount&&(this.calculateTotalObj.subTotal=this.selectedPlanObj.combo_amount)),this.calculateTotalObj.totalCouponDiscount=0,this.selectedCoupon&&this.selectedCoupon._id)if(this.selectedCoupon.amount)this.calculateTotalObj.totalCouponDiscount=this.selectedCoupon.amount<=this.calculateTotalObj.subTotal?this.selectedCoupon.amount:this.calculateTotalObj.subTotal;else if(this.selectedCoupon.percentage){const l=this.selectedCoupon.percentage*(this.calculateTotalObj.subTotal/100);this.calculateTotalObj.totalCouponDiscount=l<=this.calculateTotalObj.subTotal?l:this.calculateTotalObj.subTotal}this.calculateTotalObj.total=this.calculateTotalObj.subTotal-this.calculateTotalObj.totalCouponDiscount}onApplyCoupon(e={}){this.selectedCoupon=this._globalFunctions.copyObject(e),this.calculatePrice()}onRemoveCoupon(){this.selectedCoupon="",this.calculatePrice()}getNotificationById(){this.isLoading=!0,this._promoteService.getNotificationById(this.nId).subscribe(e=>{e&&e.IsSuccess?(this._globalService.promoteNotification$.next(e.Data),this.notificationObj=e.Data,this._prepareBillDetailsForm(e.Data),this.calculatePrice()):this._globalFunctions.successErrorHandling(e,this,!0),this.isLoading=!1},e=>{this._globalFunctions.errorHanding(e,this,!0),this.isLoading=!1})}prepareCalculatedObj(){const e=this._globalFunctions.copyObject(this.calculateTotalObj||{}),i={};return i.notificationid=this._globalFunctions.copyObject(this.nId||""),i.notification_amt=e.notificationTotal,i.sms_amt=e.smsTotal,i.email_amt=e.emailTotal,i.discount_coupon=this.selectedCoupon?._id||"",i.total=e.total,i}payNow(){if(this.isLoading)return!1;const e=this.prepareCalculatedObj();console.log(e),this.isLoading=!0,this._promoteService.processPayment(e).subscribe(i=>{i&&i.IsSuccess?(this._sNotify.success("Payment Successfully.","Success"),this.isLoading=!1):(this._globalFunctions.successErrorHandling(i,this,!0),this.isLoading=!1)},i=>{this._globalFunctions.errorHanding(i,this,!0),this.isLoading=!1})}onBackClick(){this._router.navigate(["/notifications/promote/publish-date-and-time"])}_prepareBillDetailsForm(e={}){this.billDetailsForm=this._formBuilder.group({notificationid:[this.nId,[a.kI.required]],notification_time:[e?.notification_time||""],is_notification:[e?.is_notification||!1],is_email:[e?.is_email||!1],is_sms:[e?.is_sms||!1]})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(a.qu),t.Y36(_.VZ),t.Y36(b),t.Y36(m.F0),t.Y36(f.E),t.Y36(x.U))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-bill-details"]],decls:34,vars:10,consts:[[1,""],[1,"bg-white","rounded","p-8","mt-6","space-y-5"],["class","flex items-start",4,"ngIf"],["class","flex justify-between capitalize text-magicPotion",4,"ngIf"],[1,"block","border-b-2","border-dashed","border-gray-300"],[1,"flex","justify-between","capitalize"],[1,"icon-rs","rs-black","text-lg","mr-2"],["class","",4,"ngIf"],["type","button",1,"secondary","w-full","uppercase","py-2.5","anim","mt-5",3,"click"],[1,"mt-auto"],[1,"w-full","mt-5","addsBox"],["src","/assets/images/banner-ads.png","alt","ring-ad",1,"w-full","object-cover"],[1,"prw-next-btn","mt-auto"],["type","button",1,"flex","items-center","active",3,"click"],[1,"icon-left_arrow","mr-3"],["type","button",1,"flex","items-center","active"],[1,"icon-right_arrow","ml-3"],[1,"flex","items-start"],[1,"w-8","icon-bell_fill","text-magicPotion","text-2xl","mr-5"],[1,"w-full","flex","justify-between"],[1,"text-base","text-japaneseIndigo","font-bold"],["class","text-sm text-gray-300 font-normal",4,"ngIf"],[1,"font-normal"],[1,"icon-rs","rs-black","text-base","mr-2"],[1,"text-sm","text-gray-300","font-normal"],[1,"w-8","icon-massage_fill","text-magicPotion","text-2xl","mr-5"],[1,"w-8","icon-email_fill","text-magicPotion","text-2xl","mr-5"],[1,"flex","justify-between","capitalize","text-magicPotion"],[1,"capitalize"],[4,"ngFor","ngForOf"],["class","flex justify-between items-center border border-caribbeanGreen rounded-md px-5 py-6 bg-green-50",4,"ngIf"],["class","bg-white rounded p-8 flex items-start mt-3",4,"ngIf"],[1,"flex","justify-between","items-center","border","border-caribbeanGreen","rounded-md","px-5","py-6","bg-green-50"],[1,"text-caribbeanGreen","pb-2"],[1,"text-sm","text-quicksilver"],["href","javascript:void(0);",3,"click"],[1,"icon-delete","text-magicPotion","text-2xl"],[1,"bg-white","rounded","p-8","flex","items-start","mt-3"],[1,"w-8","icon-coupan","text-magicPotion","text-2xl","mr-5"],[1,"text-sm","text-gray-300","font-normal",3,"innerHTML"],[1,"flex","items-center","text-lg","text-japaneseIndigo","capitalize"],[1,"bg-japaneseIndigo","text-white","border","border-japaneseIndigo","hover:bg-transparent","hover:text-japaneseIndigo","px-3","py-2","rounded-md","anim",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",0)(2,"h5"),t._uU(3,"Bill Details"),t.qZA(),t.TgZ(4,"div",1),t.YNc(5,H,12,6,"div",2),t.YNc(6,M,12,6,"div",2),t.YNc(7,G,12,6,"div",2),t.YNc(8,$,14,12,"div",2),t.YNc(9,K,8,4,"div",3),t._UZ(10,"span",4),t.TgZ(11,"div",5)(12,"h2"),t._uU(13,"total"),t.qZA(),t.TgZ(14,"h4"),t._UZ(15,"i",6),t._uU(16),t.ALo(17,"number"),t.qZA()()()(),t.YNc(18,et,4,1,"div",7),t.TgZ(19,"button",8),t.NdJ("click",function(){return i.payNow()}),t.TgZ(20,"h5"),t._uU(21,"Pay NOW"),t.qZA()()(),t.TgZ(22,"div",9)(23,"div",10),t._UZ(24,"img",11),t.qZA(),t.TgZ(25,"div",12)(26,"button",13),t.NdJ("click",function(){return i.onBackClick()}),t._UZ(27,"i",14),t.TgZ(28,"h5"),t._uU(29,"Back"),t.qZA()(),t.TgZ(30,"button",15)(31,"h5"),t._uU(32,"Next"),t.qZA(),t._UZ(33,"i",16),t.qZA()()()),2&e&&(t.xp6(5),t.Q6J("ngIf",i.notificationObj&&i.notificationObj.is_notification&&(!i.selectedPlanObj||i.selectedPlanObj&&!i.calculateTotalObj.planDiscount)),t.xp6(1),t.Q6J("ngIf",i.notificationObj&&i.notificationObj.is_sms&&(!i.selectedPlanObj||i.selectedPlanObj&&!i.calculateTotalObj.planDiscount)),t.xp6(1),t.Q6J("ngIf",i.notificationObj&&i.notificationObj.is_email&&(!i.selectedPlanObj||i.selectedPlanObj&&!i.calculateTotalObj.planDiscount)),t.xp6(1),t.Q6J("ngIf",i.selectedPlanObj&&i.calculateTotalObj.planDiscount),t.xp6(1),t.Q6J("ngIf",i.selectedCoupon&&i.selectedCoupon._id&&""!=i.selectedCoupon._id),t.xp6(7),t.Oqu(t.xi3(17,7,i.calculateTotalObj.total||0,"1.2-2")),t.xp6(2),t.Q6J("ngIf",i.couponsList&&i.couponsList.length))},dependencies:[d.sg,d.O5,d.JJ]}),o})()}]}];let ot=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[m.Bz.forChild(it),d.ez,T.q,a.UX,Z._8,U.L]}),o})()}}]);